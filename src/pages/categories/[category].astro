---
import Main from "@/layouts/Main.astro";
import QuestionFeed from "@/components/QuestionFeed.astro";
import { findCategory, getPublishedQuestions, listCategories } from "@/lib/questions";

export function getStaticPaths() {
  return listCategories().map((category) => ({
    params: { category: category.id },
  }));
}

const { category } = Astro.params;
const activeCategory = findCategory(category);

if (!activeCategory) {
  throw new Error(`Category not found for slug "${category}".`);
}

const matchingQuestions = getPublishedQuestions(activeCategory.id);
---

<Main title={`${activeCategory.name} Questions - abolition.ing`}>
  <QuestionFeed title="Questions & Answers" questions={matchingQuestions}>
    <fragment slot="header">
      <div class="category-header">
        <h1 class="page-title">Questions &amp; Answers</h1>
        <p class="feed-subtitle">
          In the <a class="category-parent-link" href="/categories">Category</a>: {activeCategory.name}
        </p>
      </div>
    </fragment>
    <fragment slot="empty">
      <p><em>No questions found in this category yet.</em></p>
    </fragment>
  </QuestionFeed>
</Main>
